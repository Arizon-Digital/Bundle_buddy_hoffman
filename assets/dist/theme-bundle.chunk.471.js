"use strict";(self.webpackChunkbigcommerce_cornerstone=self.webpackChunkbigcommerce_cornerstone||[]).push([[471],{30471:(t,e,a)=>{a.r(e),a.d(e,{default:()=>v});var r=a(85650),n=a(57792),o=a(13228),i=a(96609),s=a(71305),c=a(56526),d=a(88835),l=a(65117),h=(a(77462),a(41582)),u=a(80156),g=a(42240),p=a(33270);function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}function m(t,e){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},m(t,e)}var v=function(t){function e(){return t.apply(this,arguments)||this}var a,n;n=t,(a=e).prototype=Object.create(n.prototype),a.prototype.constructor=a,m(a,n);var v=e.prototype;return v.formatCategoryTreeForJSTree=function(t){var e=this,a={text:t.data,id:t.metadata.id,state:{selected:t.selected}};return t.state&&(a.state.opened="open"===t.state,a.children=!0),t.children&&(a.children=[],t.children.forEach((function(t){a.children.push(e.formatCategoryTreeForJSTree(t))}))),a},v.showProducts=function(t){if(void 0===t&&(t=!0),this.$productListingContainer.removeClass("u-hidden"),this.$facetedSearchContainer.removeClass("u-hidden"),this.$contentResultsContainer.addClass("u-hidden"),p("[data-content-results-toggle]").removeClass("navBar-action-color--active"),p("[data-content-results-toggle]").addClass("navBar-action"),p("[data-product-results-toggle]").removeClass("navBar-action"),p("[data-product-results-toggle]").addClass("navBar-action-color--active"),this.activateTab(p("[data-product-results-toggle]")),t){var e=p("#search-results-product-count span").data(),a=e.count>0?e.url:c.A.replaceParams(e.url,{page:1});c.A.goToUrl(a)}},v.showContent=function(t){if(void 0===t&&(t=!0),this.$contentResultsContainer.removeClass("u-hidden"),this.$productListingContainer.addClass("u-hidden"),this.$facetedSearchContainer.addClass("u-hidden"),p("[data-product-results-toggle]").removeClass("navBar-action-color--active"),p("[data-product-results-toggle]").addClass("navBar-action"),p("[data-content-results-toggle]").removeClass("navBar-action"),p("[data-content-results-toggle]").addClass("navBar-action-color--active"),this.activateTab(p("[data-content-results-toggle]")),t){var e=p("#search-results-content-count span").data(),a=e.count>0?e.url:c.A.replaceParams(e.url,{page:1});c.A.goToUrl(a)}},v.activateTab=function(t){p("[data-search-page-tabs]").find('[role="tab"]').each((function(e,a){var r=p(a);if(r.is(t))return r.removeAttr("tabindex"),void r.attr("aria-selected",!0);r.attr("tabindex","-1"),r.attr("aria-selected",!1)}))},v.onTabChangeWithArrows=function(t){var e=t.which;if(37===e||39===e){var a=p("[data-search-page-tabs]").find('[role="tab"]');if(-1!==a.index(p(document.activeElement))){var r,n=p("#"+document.activeElement.id),o=a.index(n),i=a.length-1;switch(e){case 37:r=0===o?i:o-1;break;case 39:r=o===i?0:o+1}p(a.get(r)).focus().trigger("click")}}},v.onReady=function(){var t=this;(0,s.A)(this.context.urls),this.arrangeFocusOnSortBy();var e=p("[data-advanced-search-form]"),a=e.find("[data-search-category-tree]"),n=d.parse(window.location.href,!0),o=[];this.$productListingContainer=p("#product-listing-container"),this.$facetedSearchContainer=p("#faceted-search-container"),this.$contentResultsContainer=p("#search-results-content"),p("#facetedSearch").length>0?this.initFacetedSearch():(this.onSortBySubmit=this.onSortBySubmit.bind(this),r.JL.on("sortBy-submitted",this.onSortBySubmit)),(0,l.Ay)(),p("[data-product-results-toggle]").on("click",(function(e){e.preventDefault(),t.showProducts()})),p("[data-content-results-toggle]").on("click",(function(e){e.preventDefault(),t.showContent()})),p("[data-search-page-tabs]").on("keyup",this.onTabChangeWithArrows),0===this.$productListingContainer.find("li.product").length||"content"===n.query.section?this.showContent(!1):this.showProducts(!1);var i=this.initValidation(e).bindValidation(e.find("#search_query_adv"));this.context.categoryTree.forEach((function(e){o.push(t.formatCategoryTreeForJSTree(e))})),this.categoryTreeData=o,this.createCategoryTree(a),e.on("submit",(function(t){var r=a.jstree().get_selected();if(!i.check())return t.preventDefault();e.find('input[name="category[]"]').remove();for(var n,o=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return(a=a.call(t)).next.bind(a);if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return f(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?f(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(r);!(n=o()).done;){var s=n.value,c=p("<input>",{type:"hidden",name:"category[]",value:s});e.append(c)}})),setTimeout((function(){p("[data-search-aria-message]").removeClass("u-hidden")}),100),this.category_sidebar(),(0,u.A)(this.context),(0,g.A)(),this.showProductsPerPage(),1==this.context.themeSettings.halo_show_more&&this.showmore_product()},v.loadTreeNodes=function(t,e){var a=this;p.ajax({url:"/remote/v1/category-tree",data:{selectedCategoryId:t.id,prefix:"category"},headers:{"x-xsrf-token":window.BCData&&window.BCData.csrf_token?window.BCData.csrf_token:""}}).done((function(t){var r=[];t.forEach((function(t){r.push(a.formatCategoryTreeForJSTree(t))})),e(r)}))},v.createCategoryTree=function(t){var e=this,a={core:{data:function(t,a){"#"===t.id?a(e.categoryTreeData):e.loadTreeNodes(t,a)},themes:{icons:!0}},checkbox:{three_state:!1},plugins:["checkbox"]};t.jstree(a)},v.initFacetedSearch=function(){var t=this,e=this.context,a=e.onMinPriceError,r=e.onMaxPriceError,n=e.minPriceNotEntered,i=e.maxPriceNotEntered,s=e.onInvalidPrice,c=p("#product-listing-container"),l=p("#search-results-content"),h=p("#faceted-search-container"),f=p("#search-results-heading"),m=p("#search-results-product-count"),v=p("#search-results-content-count"),b={template:{productListing:"search/product-listing",contentListing:"search/content-listing",sidebar:"search/sidebar",heading:"search/heading",productCount:"search/product-count",contentCount:"search/content-count"},config:{product_results:{limit:this.context.searchProductsPerPage}},showMore:"search/show-more"};this.facetedSearch=new o.A(b,(function(e){f.html(e.heading),"content"===d.parse(window.location.href,!0).query.section?(l.html(e.contentListing),v.html(e.contentCount),t.showContent(!1)):(c.html(e.productListing),h.html(e.sidebar),m.html(e.productCount),t.showProducts(!1)),p("body").triggerHandler("compareReset"),p("html, body").animate({scrollTop:0},100),t.category_sidebar(),(0,u.A)(t.context),(0,g.A)(),t.showProductsPerPage(),1==t.context.themeSettings.halo_show_more&&t.showmore_product()}),{validationErrorMessages:{onMinPriceError:a,onMaxPriceError:r,minPriceNotEntered:n,maxPriceNotEntered:i,onInvalidPrice:s}})},v.initValidation=function(t){return this.$form=t,this.validator=(0,h.A)({submit:t,tap:i.dN}),this},v.bindValidation=function(t){return this.validator&&this.validator.add({selector:t,validate:"presence",errorMessage:t.data("errorMessage")}),this},v.check=function(){return!!this.validator&&(this.validator.performCheck(),this.validator.areAll("valid"))},v.category_sidebar=function(){p(".all-categories-list").length>0&&(p("ul.all-categories-list li").each((function(){var t=p(".page-type-product #breadcrumbs-wrapper ul li.breadcrumb.is-active").prev(".breadcrumb").children("a").attr("href");p(this).children("a").attr("href")!=window.location&&p(this).children("a").attr("href")!=window.location.pathname||(p(this).addClass("current-cat"),p(this).children(".dropdown-category-list").addClass("cat-expanded").siblings(".icon-dropdown").addClass("is-clicked"),p(this).parents(".dropdown-category-list").addClass("cat-expanded").siblings(".icon-dropdown").addClass("is-clicked")),p(this).children("a").attr("href")==t&&(p(this).addClass("current-cat"),p(this).parents(".dropdown-category-list").addClass("cat-expanded").siblings(".icon-dropdown").addClass("is-clicked"))})),p(".all-categories-list .icon-dropdown").on("click",(function(){p(this).parent().siblings().removeClass("is-clicked"),p(this).parent().siblings().find("> .dropdown-category-list").slideUp("slow"),p(this).parent().siblings().find("> .icon-dropdown").removeClass("is-clicked"),p(this).parent().find("> .dropdown-category-list").slideToggle("slow"),p(this).parent().siblings().removeClass("open"),p(this).hasClass("is-clicked")?(p(this).removeClass("is-clicked"),p(this).parent().removeClass("open")):(p(this).addClass("is-clicked"),p(this).parent().addClass("open"))})))},v.showProductsPerPage=function(){try{var t=new URL(window.location.href).searchParams.get("limit");if(null!=t){var e=document.querySelectorAll("select#limit option");Array.prototype.forEach.call(e,(function(e){e.value==t&&(e.selected=!0)}))}}catch(t){}},v.showmore_product=function(){var t=this;this.context,p("#button-showmore-category").on("click",(function(e){e.preventDefault();var a=p(".pagination-wrapper .pagination-item--current").next(),r=a.find("a").attr("href");null==r?p("#button-showmore-category").hasClass("disable")||p("#button-showmore-category").addClass("disable"):(p("#button-showmore-category").addClass("loading"),p.ajax({type:"get",url:r.replace("http://","//"),context:t.content,success:function(t){p(t).find("#product-listing-container .productListing").length>0&&(p("#product-listing-container .productListing").append(p(t).find("#product-listing-container .productListing").children()),p(".pagination-list").html(p(t).find(".pagination-list").html()),p("#button-showmore-category").removeClass("loading"),a=p(".pagination-wrapper .pagination-item--current").next(),Number(p(t).find(".pagination-info .end").text())<Number(p(t).find(".pagination-info .total").text())?p(".pagination .pagination-info .end").html(p(t).find(".pagination-info .end").text()):p(".pagination .pagination-info .end").html(p(t).find(".pagination-info .total").text()),0===a.length&&(p("#button-showmore-category").addClass("disable"),p("#button-showmore-category > span").text("No more product")),p("#product-listing-container .card-variant").attr("id"))}}))}))},e}(n.A)}}]);
//# sourceMappingURL=theme-bundle.chunk.471.js.map